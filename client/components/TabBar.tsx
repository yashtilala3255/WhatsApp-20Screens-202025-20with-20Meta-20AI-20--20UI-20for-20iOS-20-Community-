import { Link, useLocation } from "react-router-dom";

export function TabBar() {
  const location = useLocation();
  const currentPath = location.pathname;

  // Determine active tab based on current path
  const getActiveTab = () => {
    if (currentPath === "/" || currentPath === "/updates") return "updates";
    if (currentPath === "/calls") return "calls";
    if (currentPath === "/communities") return "communities";
    if (currentPath === "/settings") return "settings";
    if (
      currentPath === "/chats" ||
      currentPath.startsWith("/chat") ||
      currentPath.startsWith("/new-chat") ||
      currentPath.startsWith("/group") ||
      currentPath.startsWith("/contacts") ||
      currentPath.startsWith("/search") ||
      currentPath.startsWith("/archive")
    )
      return "chats";
    return "updates";
  };

  const activeTab = getActiveTab();

  return (
    <div className="flex w-full flex-col items-center relative">
      <div className="flex px-6 py-[3px] justify-between items-start w-full">
        {/* Updates Tab */}
        <Link to="/" className="flex flex-col items-center w-8">
          <div className="w-8 h-8 flex items-center justify-center">
            <svg width="24" height="24" viewBox="0 0 26 26" fill="none">
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M7.26311 4.16555C9.00872 3.03193 11.0511 2.4409 13.1323 2.46704C15.2135 2.49319 17.2404 3.13535 18.9569 4.31245C19.3213 4.56232 19.8193 4.46949 20.0692 4.1051C20.319 3.74072 20.2262 3.24277 19.8618 2.9929C17.8845 1.63699 15.5498 0.897287 13.1524 0.867169C10.755 0.837051 8.40246 1.51787 6.39169 2.82367C6.02114 3.06431 5.91583 3.55977 6.15646 3.93032C6.3971 4.30087 6.89256 4.40618 7.26311 4.16555ZM23.2469 6.50193C23.0103 6.12879 22.516 6.01812 22.1428 6.25472C21.7697 6.49133 21.659 6.98562 21.8956 7.35876C23.0011 9.10219 23.57 11.1321 23.5315 13.1961C23.4929 15.2601 22.8488 17.2674 21.6789 18.9683C21.4286 19.3324 21.5207 19.8305 21.8848 20.0808C22.2488 20.3312 22.7469 20.239 22.9973 19.875C24.3448 17.9156 25.0868 15.6035 25.1312 13.226C25.1756 10.8484 24.5203 8.51019 23.2469 6.50193ZM6.79997 12.9995C6.79997 9.57538 9.57581 6.79955 13 6.79955C16.4241 6.79955 19.2 9.57538 19.2 12.9995C19.2 16.4237 16.4241 19.1995 13 19.1995C9.57581 19.1995 6.79997 16.4237 6.79997 12.9995ZM13 5.19954C8.69215 5.19954 5.19997 8.69172 5.19997 12.9995C5.19997 17.3074 8.69215 20.7995 13 20.7995C17.3078 20.7995 20.8 17.3074 20.8 12.9995C20.8 8.69172 17.3078 5.19954 13 5.19954Z"
                fill={activeTab === "updates" ? "#0A0A0A" : "#767779"}
              />
            </svg>
          </div>
          <div
            className={`text-[10px] font-medium tracking-[0.05px] ${activeTab === "updates" ? "text-black" : "text-[#767779]"}`}
          >
            Updates
          </div>
        </Link>

        {/* Calls Tab */}
        <Link to="/calls" className="flex flex-col items-center w-8">
          <div className="w-8 h-8 flex items-center justify-center">
            <svg width="23" height="23" viewBox="0 0 24 24" fill="none">
              <path
                d="M17.996 23.2355C14.6084 23.2355 10.5166 21.0014 6.77687 17.2739C3.02502 13.522 0.815186 9.41803 0.815186 6.00615C0.815186 4.08773 1.37371 2.67927 2.68504 1.46507C2.77004 1.39222 2.84289 1.31937 2.91574 1.25866C3.69282 0.530144 4.50633 0.165886 5.24699 0.178028C6.03621 0.202312 6.76473 0.62728 7.39611 1.55007L9.8245 5.07122C10.5166 6.06686 10.6259 7.24463 9.5938 8.30098L8.71958 9.18734C8.45246 9.45446 8.40389 9.74587 8.58602 10.0737C9.0717 10.9236 9.87306 11.8343 11.0023 12.9635C12.0343 13.9955 13.3821 15.1005 13.977 15.4647C14.3049 15.6468 14.5963 15.5983 14.8634 15.3312L15.7498 14.4569C16.8061 13.4249 17.9839 13.5341 18.9795 14.2262L22.5007 16.6546C23.4235 17.286 23.8727 18.0145 23.8727 18.8037C23.8727 19.5444 23.5206 20.3458 22.7921 21.135C22.7314 21.2078 22.6585 21.2807 22.5857 21.3657C21.3593 22.6892 19.9387 23.2355 17.996 23.2355Z"
                fill={activeTab === "calls" ? "#0A0A0A" : "#767779"}
              />
            </svg>
          </div>
          <div
            className={`text-[10px] font-medium tracking-[0.05px] ${activeTab === "calls" ? "text-black" : "text-[#767779]"}`}
          >
            Calls
          </div>
        </Link>

        {/* Communities Tab */}
        <Link to="/communities" className="flex flex-col items-center w-8">
          <div className="w-8 h-8 flex items-center justify-center">
            <div
              className={`w-[31px] h-[21px] ${activeTab === "communities" ? "bg-black" : "bg-[#767779]"}`}
            ></div>
          </div>
          <div
            className={`text-[10px] font-medium tracking-[0.05px] ${activeTab === "communities" ? "text-black" : "text-[#767779]"}`}
          >
            Communities
          </div>
        </Link>

        {/* Chats Tab with Badge */}
        <Link to="/chats" className="flex flex-col items-center w-8 relative">
          <div className="w-8 h-8 flex items-center justify-center">
            <svg width="32" height="23" viewBox="0 0 33 23" fill="none">
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M2.04998 10.1669C2.04998 5.71506 6.72468 1.8002 12.9166 1.8002C19.1086 1.8002 23.7833 5.71506 23.7833 10.1669C23.7833 14.6187 19.1086 18.5335 12.9166 18.5335C12.5394 18.5335 12.1669 18.5187 11.7999 18.4897C11.3645 18.4554 10.9397 18.613 10.6315 18.9119C9.35111 20.1538 8.06296 20.766 7.10745 21.0693C7.05691 21.0853 7.0073 21.1005 6.95865 21.1148C7.0433 20.9138 7.12837 20.7016 7.20842 20.4856C7.40244 19.9623 7.58638 19.3669 7.64416 18.8404C7.67283 18.5793 7.67755 18.2777 7.59996 17.9895C7.51796 17.6849 7.32722 17.3475 6.94612 17.1536C6.622 16.9886 6.31042 16.8109 6.01253 16.6215C3.5426 15.0512 2.04998 12.7111 2.04998 10.1669Z"
                fill={activeTab === "chats" ? "#0A0A0A" : "#767779"}
              />
            </svg>
          </div>
          <div
            className={`text-[10px] font-medium tracking-[0.05px] ${activeTab === "chats" ? "text-black" : "text-[#767779]"}`}
          >
            Chats
          </div>
          {/* Badge */}
          <div className="absolute -top-0 right-0 w-[18px] h-[18px] bg-[#1DAB61] rounded-full flex items-center justify-center">
            <span className="text-white text-xs font-normal tracking-[-0.12px]">
              1
            </span>
          </div>
        </Link>

        {/* Settings Tab */}
        <Link to="/settings" className="flex flex-col items-center w-8">
          <div className="w-8 h-8 flex items-center justify-center">
            {activeTab === "settings" ? (
              <svg width="27" height="27" viewBox="0 0 28 28" fill="none">
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M14.8401 25.7189C14.5508 25.7422 14.2808 25.7639 14 25.7639C13.7067 25.7639 13.4352 25.7421 13.1449 25.7187C13.1233 25.717 13.1017 25.7153 13.0798 25.7135L12.4118 27.0118C12.2731 27.2891 11.9832 27.4404 11.6555 27.39C11.3277 27.3396 11.1134 27.1001 11.063 26.7723L10.8613 25.3354C10.2815 25.1841 9.71429 24.9572 9.14706 24.7177L8.10084 25.6757C7.86134 25.9026 7.54622 25.9404 7.2437 25.7765C6.96639 25.6127 6.85294 25.3228 6.91597 24.995L7.21849 23.5833C6.72689 23.2429 6.2479 22.8522 5.81933 22.4236L4.4958 22.9782C4.18067 23.1043 3.89076 23.0412 3.65126 22.7513C3.43697 22.5244 3.41176 22.1967 3.58824 21.9194L4.35714 20.6967C4.01681 20.2051 3.72689 19.6757 3.46218 19.1211L2.01261 19.1841C1.69748 19.2093 1.42017 19.0202 1.30672 18.7177C1.21849 18.4026 1.30672 18.1001 1.55882 17.8984L2.69328 17.0034C2.54202 16.4362 2.41597 15.8312 2.37815 15.2135L1.0042 14.7723C0.689076 14.6715 0.5 14.432 0.5 14.0917C0.5 13.7513 0.689076 13.5118 1.0042 13.411L2.37815 12.9698C2.41597 12.3522 2.54202 11.7597 2.69328 11.1799L1.55882 10.2849C1.29412 10.0833 1.20588 9.79334 1.30672 9.47821C1.42017 9.17569 1.69748 8.98662 2.01261 9.01183L3.46218 9.06225C3.7395 8.50763 4.01681 7.99082 4.35714 7.48662L3.58824 6.25132C3.42437 5.99922 3.44958 5.67149 3.65126 5.4446C3.89076 5.16729 4.18067 5.09166 4.4958 5.21771L5.81933 5.75973C6.2479 5.34376 6.72689 4.9404 7.21849 4.60006L6.91597 3.2009C6.85294 2.86057 6.96639 2.57065 7.2437 2.41939C7.54622 2.25553 7.84874 2.28074 8.10084 2.52023L9.15966 3.46561C9.71429 3.21351 10.2815 3.01183 10.8613 2.84796L11.063 1.42359C11.1134 1.09586 11.3277 0.868971 11.6429 0.805946C11.9832 0.76813 12.2731 0.906786 12.4118 1.17149L13.0798 2.46981C13.4076 2.4446 13.6849 2.432 14 2.432C14.3025 2.432 14.5924 2.4446 14.9076 2.46981L15.5882 1.17149C15.7143 0.906786 16.0042 0.76813 16.3445 0.805946C16.6597 0.868971 16.8739 1.09586 16.9244 1.42359L17.1261 2.84796C17.7059 3.01183 18.2731 3.21351 18.8403 3.46561L19.8992 2.52023C20.1387 2.28074 20.4412 2.25553 20.7563 2.41939C21.021 2.57065 21.1345 2.86057 21.0714 3.2009L20.7815 4.60006C21.2605 4.9404 21.7395 5.34376 22.1807 5.75973L23.4916 5.21771C23.8067 5.09166 24.0966 5.16729 24.3361 5.4446C24.5504 5.67149 24.5756 5.99922 24.3992 6.26393L23.6303 7.48662C23.9706 7.99082 24.2605 8.50763 24.5252 9.06225L25.9748 9.01183C26.3025 8.98662 26.5798 9.17569 26.6807 9.47821C26.7815 9.79334 26.6807 10.0833 26.4286 10.2849L25.2941 11.1799C25.4454 11.7597 25.5714 12.3522 25.6218 12.9698L26.9832 13.411C27.2983 13.5244 27.5 13.7639 27.5 14.0917C27.5 14.4194 27.2983 14.6589 26.9832 14.7723L25.6218 15.2135C25.5714 15.8312 25.4454 16.4362 25.2941 17.0034L26.4286 17.8984C26.6933 18.1001 26.7815 18.4026 26.6807 18.7177C26.5798 19.0202 26.3025 19.2093 25.9748 19.1841L24.5252 19.1211C24.2605 19.6757 23.9706 20.2051 23.6303 20.6967L24.3992 21.9194C24.5756 22.1967 24.5504 22.5244 24.3361 22.7513C24.0966 23.0412 23.8067 23.1043 23.4916 22.9782L22.1807 22.4236C21.7395 22.8522 21.2605 23.2429 20.7815 23.5833L21.0714 24.995C21.1345 25.3228 21.021 25.6127 20.7563 25.7765C20.4412 25.9404 20.1261 25.9026 19.8992 25.6757L18.8403 24.7177C18.2731 24.9572 17.7059 25.1841 17.1261 25.3354L16.9244 26.7723C16.8739 27.1001 16.6597 27.3396 16.3445 27.39C16.0042 27.4404 15.7143 27.2891 15.5882 27.0118L14.9076 25.7135C14.885 25.7153 14.8625 25.7171 14.8401 25.7189Z"
                  fill="#0A0A0A"
                />
              </svg>
            ) : (
              <svg width="27" height="27" viewBox="0 0 32 32" fill="none">
                <path
                  d="M16.0001 27.7644C16.3026 27.7644 16.5926 27.7392 16.9077 27.714L17.5884 29.0123C17.7144 29.2896 18.0043 29.4409 18.3447 29.3904C18.6598 29.34 18.8741 29.1005 18.9245 28.7728L19.1262 27.3358C19.706 27.1845 20.2733 26.9576 20.8405 26.7182L21.8993 27.6761C22.1262 27.903 22.4413 27.9409 22.7565 27.777C23.0212 27.6131 23.1346 27.3232 23.0716 26.9955L22.7817 25.5837C23.2607 25.2433 23.7397 24.8526 24.1808 24.424L25.4918 24.9786C25.8069 25.1047 26.0968 25.0417 26.3363 24.7517C26.5506 24.5249 26.5758 24.1971 26.3994 23.9198L25.6304 22.6971C25.9708 22.2055 26.2607 21.6761 26.5254 21.1215L27.975 21.1845C28.3027 21.2097 28.58 21.0206 28.6809 20.7181C28.7817 20.403 28.6935 20.1005 28.4288 19.8988L27.2943 19.0038C27.4456 18.4366 27.5716 17.8315 27.6221 17.2139L28.9834 16.7727C29.2985 16.6592 29.5002 16.4197 29.5002 16.092C29.5002 15.7643 29.2985 15.5248 28.9834 15.4113L27.6221 14.9702C27.5716 14.3525 27.4456 13.7601 27.2943 13.1802L28.4288 12.2853C28.6809 12.0836 28.7817 11.7937 28.6809 11.4785C28.58 11.176 28.3027 10.9869 27.975 11.0121L26.5254 11.0626C26.2607 10.5079 25.9708 9.99112 25.6304 9.48692L26.3994 8.26422C26.5758 7.99951 26.5506 7.67178 26.3363 7.44488C26.0966 7.16757 25.8069 7.09194 25.4918 7.21799L24.1808 7.76001C23.7397 7.34404 23.2607 6.94068 22.7817 6.60034L23.0716 5.20117C23.1346 4.86083 23.0212 4.57091 22.7565 4.41965C22.4413 4.25578 22.1388 4.28099 21.8993 4.52049L20.8405 5.46588C20.2733 5.21377 19.706 5.01209 19.1262 4.84822L18.9245 3.42384C18.8741 3.09611 18.6598 2.86922 18.3447 2.80619C18.0043 2.76837 17.7144 2.90703 17.5884 3.17174L16.9077 4.47007C16.5926 4.44486 16.3026 4.43225 16.0001 4.43225C15.685 4.43225 15.4077 4.44486 15.0799 4.47007L14.4119 3.17174C14.2732 2.90703 13.9833 2.76837 13.6429 2.80619C13.3278 2.86922 13.1135 3.09611 13.0631 3.42384L12.8614 4.84822C12.2816 5.01209 11.7144 5.21377 11.1597 5.46588L10.1009 4.52049C9.8488 4.28099 9.54628 4.25578 9.24375 4.41965C8.96644 4.57091 8.85299 4.86083 8.91602 5.20117L9.21854 6.60034C8.73979 6.94068 8.26083 7.34404 7.8197 7.76001L6.50866 7.21799C6.19354 7.09194 5.90362 7.16757 5.66412 7.44488C5.43958 7.67178 5.41437 7.99951 5.59081 8.26422L6.35979 9.48692C6.02004 9.99112 5.73013 10.5079 5.46542 11.0626L4.01583 11.0121C3.67554 10.9869 3.3982 11.176 3.29737 11.4785C3.18395 11.7937 3.29737 12.0836 3.56208 12.2853L4.69658 13.1802C4.54529 13.7601 4.41929 14.3525 4.38141 14.9702L3.02004 15.4113C2.70491 15.5248 2.50329 15.7643 2.50329 16.092C2.50329 16.4197 2.70491 16.6592 3.02004 16.7727L4.38141 17.2139C4.41929 17.8315 4.54529 18.4366 4.69658 19.0038L3.56208 19.8988C3.29737 20.1005 3.18395 20.403 3.29737 20.7181C3.3982 21.0206 3.67554 21.2097 4.01583 21.1845L5.46542 21.1215C5.73013 21.6761 6.02004 22.2055 6.35979 22.6971L5.59081 23.9198C5.41437 24.1971 5.43958 24.5249 5.66412 24.7517C5.90362 25.0417 6.19354 25.1047 6.50866 24.9786L7.8197 24.424C8.26083 24.8526 8.73979 25.2433 9.21854 25.5837L8.91602 26.9955C8.85299 27.3232 8.96644 27.6131 9.24375 27.777C9.54628 27.9409 9.86141 27.903 10.1009 27.6761L11.1597 26.7182C11.7144 26.9576 12.2816 27.1845 12.8614 27.3358L13.0631 28.7728C13.1135 29.1005 13.3278 29.34 13.6429 29.3904C13.9833 29.4409 14.2732 29.2896 14.4119 29.0123L15.0799 27.714C15.4077 27.7392 15.685 27.7644 16.0001 27.7644Z"
                  fill="#767779"
                />
              </svg>
            )}
          </div>
          <div
            className={`text-[10px] font-medium tracking-[0.05px] ${activeTab === "settings" ? "text-black" : "text-[#767779]"}`}
          >
            Settings
          </div>
        </Link>
      </div>

      {/* Home Indicator */}
      <div className="py-[21px] pb-2 w-full flex justify-center">
        <div className="w-[140px] h-[5px] bg-black rounded-full"></div>
      </div>
    </div>
  );
}

export default TabBar;
